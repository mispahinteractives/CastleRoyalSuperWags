import l from "path";
import p from "fs";
function h(i) {
  let n;
  return {
    name: "html-injection",
    configResolved(r) {
      n = r;
    },
    transformIndexHtml(r) {
      let e = r;
      for (let a = 0; a < i.injections.length; a++) {
        const o = i.injections[a];
        let c = n.root;
        const s = l.resolve(c, o.path);
        let t = p.readFileSync(s, "utf8");
        switch (o.type === "js" ? t = `<script>
${t}
<\/script>
` : o.type === "css" && (t = `<style>
${t}
</style>
`), o.injectTo) {
          case "head":
            e = e.replace("</head>", `${t}
</head>`);
            break;
          case "head-prepend":
            e = e.replace(/<head(.*)>/i, `$&
${t}`);
            break;
          case "body":
            e = e.replace("</body>", `${t}
</body>`);
            break;
          case "body-prepend":
            e = e.replace(/<body(.*)>/i, `$&
${t}`);
            break;
        }
      }
      return e;
    }
  };
}
export {
  h as htmlInjectionPlugin
};
